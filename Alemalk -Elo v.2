{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3c502d8c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'\\n+ 1. Создание игрока по имение и присовение ему стандартных параметров raiting и winrate.  Заведение их в сводную таблицу \\n+ 2. Выбор игроков участвующих в матче\\n+ 3. Разбиение игроков на команды (команд больше 2). Ручной режим (пока хз как) и автоматическая балансировка\\n+ 4. Расчет ЭЛО-рейтинга для команд. \\n+ 5. Перерасчет показателей rating и winrate для игроков по итогу матча (игроки пропустившие матч получают -0,5% от рейтинга)\\n+ 6. Сохраниеие данных. Импорт и экпорд данных.\\n'"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Эло рейтинг для футбола\n",
    "'''\n",
    "+ 1. Создание игрока по имение и присовение ему стандартных параметров raiting и winrate.  Заведение их в сводную таблицу \n",
    "+ 2. Выбор игроков участвующих в матче\n",
    "+ 3. Разбиение игроков на команды (команд больше 2). Ручной режим (пока хз как) и автоматическая балансировка\n",
    "+ 4. Расчет ЭЛО-рейтинга для команд. \n",
    "+ 5. Перерасчет показателей rating и winrate для игроков по итогу матча (игроки пропустившие матч получают -0,5% от рейтинга)\n",
    "+ 6. Сохраниеие данных. Импорт и экпорд данных.\n",
    "'''"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3a470d15",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "2ea09d74",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from typing import List, Tuple"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "2bf1c2e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "def save_df():\n",
    "    ''' Сохранение датасета'''\n",
    "    df.to_csv(\"PlayersList.csv\", index=False)\n",
    "    print(\"Сохранение завершено\")\n",
    "\n",
    "# работает"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "6186f779",
   "metadata": {},
   "outputs": [],
   "source": [
    "def load_df():\n",
    "    ''' Загрузка датасета'''\n",
    "    \n",
    "    return pd.read_csv(\"PlayersList.csv\")\n",
    "\n",
    "# работает"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "7c83bf1b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>rating</th>\n",
       "      <th>games</th>\n",
       "      <th>wins</th>\n",
       "      <th>defeats</th>\n",
       "      <th>draws</th>\n",
       "      <th>winrate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Николай</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Миша</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Кэп</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Ваня</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Макс</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Андрей</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Кирпич</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Даня</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Валера</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Толя</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Кирилл (Родионов)</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Вася</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Роман</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Саша</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Костя</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Стас</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Кирилл (высокий с Ваниной работы)</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Влад</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                 name  rating  games  wins  defeats  draws  \\\n",
       "0                             Николай  2500.0    0.0   0.0      0.0    0.0   \n",
       "1                                Миша  2500.0    0.0   0.0      0.0    0.0   \n",
       "2                                 Кэп  2525.0    1.0   1.0      0.0    0.0   \n",
       "3                                Ваня  2475.0    1.0   0.0      1.0    0.0   \n",
       "4                                Макс  2475.0    1.0   0.0      1.0    0.0   \n",
       "5                              Андрей  2475.0    1.0   0.0      1.0    0.0   \n",
       "6                              Кирпич  2525.0    1.0   1.0      0.0    0.0   \n",
       "7                                Даня  2500.0    0.0   0.0      0.0    0.0   \n",
       "8                              Валера  2525.0    1.0   1.0      0.0    0.0   \n",
       "9                                Толя  2525.0    1.0   1.0      0.0    0.0   \n",
       "10                  Кирилл (Родионов)  2525.0    1.0   1.0      0.0    0.0   \n",
       "11                               Вася  2475.0    1.0   0.0      1.0    0.0   \n",
       "12                              Роман  2500.0    0.0   0.0      0.0    0.0   \n",
       "13                               Саша  2500.0    0.0   0.0      0.0    0.0   \n",
       "14                              Костя  2500.0    0.0   0.0      0.0    0.0   \n",
       "15                               Стас  2500.0    0.0   0.0      0.0    0.0   \n",
       "16  Кирилл (высокий с Ваниной работы)  2475.0    1.0   0.0      1.0    0.0   \n",
       "17                               Влад  2500.0    0.0   0.0      0.0    0.0   \n",
       "\n",
       "    winrate  \n",
       "0       0.0  \n",
       "1       0.0  \n",
       "2     100.0  \n",
       "3       0.0  \n",
       "4       0.0  \n",
       "5       0.0  \n",
       "6     100.0  \n",
       "7       0.0  \n",
       "8     100.0  \n",
       "9     100.0  \n",
       "10    100.0  \n",
       "11      0.0  \n",
       "12      0.0  \n",
       "13      0.0  \n",
       "14      0.0  \n",
       "15      0.0  \n",
       "16      0.0  \n",
       "17      0.0  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = load_df()\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "f45c01c6",
   "metadata": {},
   "outputs": [],
   "source": [
    "full_stuck = pd.DataFrame() \n",
    "\n",
    "team_1 = pd.DataFrame()                \n",
    "team_2 = pd.DataFrame()\n",
    "\n",
    "team_a = pd.DataFrame()                \n",
    "team_b = pd.DataFrame() \n",
    "                        \n",
    "#team_3 = pd.DataFrame()    \n",
    "#team_4 = pd.DataFrame()     "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "362bfe6c",
   "metadata": {},
   "outputs": [],
   "source": [
    "def new_player(name, rating = 2500, games = 0, wins = 0, defeats = 0,  draws = 0, winrate = 0, df = df):\n",
    "    \"\"\"\n",
    "    Создание игрока\n",
    "    Если рейтинг не указан - присваевается стандартный (наверно 2500)\n",
    "    Если кол-во игр не указано - присваевается 0\n",
    "    Если винрейт не указан - присваевается стандартный (0)\n",
    "    \"\"\"\n",
    "    name = name\n",
    "    rating = rating\n",
    "    games = games\n",
    "    wins = wins\n",
    "    winrate = winrate\n",
    "    df = df\n",
    "    newplayer = {'name':name, 'rating':rating, 'games':games, 'wins':wins, 'defeats':defeats, 'draws':draws, 'winrate':winrate}\n",
    "    df = df.append(newplayer, ignore_index=True)\n",
    "    return df\n",
    "\n",
    "# работает\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "34effb3f",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2b8567f4",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "79b78739",
   "metadata": {},
   "outputs": [],
   "source": [
    "def team_bilding(plaeyer_name:str, full_stuck = full_stuck, df = df):\n",
    "    \"\"\"\n",
    "    Создает команду для матча\n",
    "    Передаем имя игрока (должно быть уникальным)\n",
    "    Передаем Дата-Фрейм команды\n",
    "    Добавляется по одному игроку\n",
    "    \"\"\"\n",
    "    \n",
    "    plaeyer_name = plaeyer_name\n",
    "    full_stuck = full_stuck\n",
    "    df = df\n",
    "    full_stuck = full_stuck.append(df.loc[df['name'] == plaeyer_name], ignore_index=True)\n",
    "    return team_df\n",
    "\n",
    "# работает"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "51ae4a48",
   "metadata": {},
   "outputs": [],
   "source": [
    "team_a = team_a.append(df.loc[df['name'] == 'Влад'], ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "c5a01a17",
   "metadata": {},
   "outputs": [],
   "source": [
    "team_a = team_a.append(df.loc[df['name'] == 'Кэп'], ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "956a8e6d",
   "metadata": {},
   "outputs": [],
   "source": [
    "team_a = team_a.append(df.loc[df['name'] == 'Валера'], ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "62a9132f",
   "metadata": {},
   "outputs": [],
   "source": [
    "team_a = team_a.append(df.loc[df['name'] == 'Кирпич'], ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "b0eca300",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>rating</th>\n",
       "      <th>games</th>\n",
       "      <th>wins</th>\n",
       "      <th>defeats</th>\n",
       "      <th>draws</th>\n",
       "      <th>winrate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Влад</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Кэп</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Валера</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Кирпич</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     name  rating  games  wins  defeats  draws  winrate\n",
       "0    Влад  2500.0    0.0   0.0      0.0    0.0      0.0\n",
       "1     Кэп  2525.0    1.0   1.0      0.0    0.0    100.0\n",
       "2  Валера  2525.0    1.0   1.0      0.0    0.0    100.0\n",
       "3  Кирпич  2525.0    1.0   1.0      0.0    0.0    100.0"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "team_a"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "672d38b7",
   "metadata": {},
   "outputs": [],
   "source": [
    "team_b = team_b.append(df.loc[df['name'] == 'Макс'], ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "b3ef720c",
   "metadata": {},
   "outputs": [],
   "source": [
    "team_b = team_b.append(df.loc[df['name'] == 'Роман'], ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "a6662dcf",
   "metadata": {},
   "outputs": [],
   "source": [
    "team_b = team_b.append(df.loc[df['name'] == 'Костя'], ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "e55fe67a",
   "metadata": {},
   "outputs": [],
   "source": [
    "team_b = team_b.append(df.loc[df['name'] == 'Саша'], ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "5591808c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>rating</th>\n",
       "      <th>games</th>\n",
       "      <th>wins</th>\n",
       "      <th>defeats</th>\n",
       "      <th>draws</th>\n",
       "      <th>winrate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Макс</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Роман</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Костя</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Саша</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    name  rating  games  wins  defeats  draws  winrate\n",
       "0   Макс  2475.0    1.0   0.0      1.0    0.0      0.0\n",
       "1  Роман  2500.0    0.0   0.0      0.0    0.0      0.0\n",
       "2  Костя  2500.0    0.0   0.0      0.0    0.0      0.0\n",
       "3   Саша  2500.0    0.0   0.0      0.0    0.0      0.0"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "team_b"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "d4305a2f",
   "metadata": {},
   "outputs": [],
   "source": [
    "def list_of_players(df):\n",
    "    \"\"\"\n",
    "    Воводит список всех игроков (список имен из столбца 'name')\n",
    "    \"\"\"      \n",
    "    \n",
    "    df = df\n",
    "    players_list = df.name.tolist()\n",
    "    return players_list\n",
    "\n",
    "# работает"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "92cef211",
   "metadata": {},
   "outputs": [],
   "source": [
    "def re_name(old_name:str, new_name:str, df = df):\n",
    "    \"\"\"\n",
    "    Перемименовывание игрока.\n",
    "    На вход подаются два параметра\n",
    "    old_name - старое имя, которое указано в датафрейме\n",
    "    new_name - имя на которое будет изменено\n",
    "    \"\"\"         \n",
    "    df = df\n",
    "    old_name = old_name\n",
    "    new_name = new_name\n",
    "    lf = list_of_players(df)\n",
    "    i = lf.index(old_name)\n",
    "    df.at[i, \"name\"] = new_name\n",
    "    return df    \n",
    "    \n",
    "# работает"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "f1fa394a",
   "metadata": {},
   "outputs": [],
   "source": [
    "def remove_player(remove_name, df=df):\n",
    "    '''\n",
    "    Удаление игрока по имени\n",
    "    на вход подается имя, которое указано в датафрейме\n",
    "    '''\n",
    "    df =df    \n",
    "    remove_name = remove_name\n",
    "    lf = list_of_players(df)\n",
    "    i = lf.index(remove_name)\n",
    "    df = df.drop(labels = i, axis = 0)\n",
    "    return df\n",
    "\n",
    "# работает"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "136621ef",
   "metadata": {},
   "outputs": [],
   "source": [
    "def knapsack_balance(ratings: List[float],\n",
    "                     precision: float = 1.0) -> Tuple[List[int], List[int]]:\n",
    "    \"\"\"\n",
    "    Разбивает список чисел примерно на две равные группы с точностью precision.\n",
    "    Большая точность требует больших вычислений\n",
    "    \n",
    "    Args:\n",
    "        ratings: список чисел для разбиения\n",
    "        precision: максимальная желаемая разница между идеальной разницей сумм\n",
    "                   и вычисленной этой процедурой\n",
    "        \n",
    "    Returns:\n",
    "        Два списка: индексы первой группы и второй группы соответственно\n",
    "    \"\"\"\n",
    "\n",
    "    single_value_precision_reverse = len(ratings) * precision / 2\n",
    "\n",
    "    values = [round(x * single_value_precision_reverse) for x in ratings]\n",
    "\n",
    "    class SearchToken:\n",
    "        def __init__(self, parent, current_sum, value_index):\n",
    "            self.parent = parent\n",
    "            self.current_sum = current_sum\n",
    "            self.value_index = value_index\n",
    "\n",
    "        def backtrace(self):\n",
    "            list_a = []\n",
    "            list_b = []\n",
    "            cur = self\n",
    "            while cur.parent is not None:\n",
    "                if cur.current_sum == cur.parent.current_sum:\n",
    "                    list_b.append(cur.value_index)\n",
    "                else:\n",
    "                    list_a.append(cur.value_index)\n",
    "                cur = cur.parent\n",
    "\n",
    "            return list_a, list_b\n",
    "\n",
    "    tokens = {0: SearchToken(None, 0, -1)}\n",
    "\n",
    "    for i, value in enumerate(values):\n",
    "        new_tokens = dict()\n",
    "        for accumulated_sum, token in tokens.items():\n",
    "            if accumulated_sum not in new_tokens:\n",
    "                new_tokens[accumulated_sum] = SearchToken(token, accumulated_sum, i)\n",
    "            if accumulated_sum + value not in new_tokens:\n",
    "                new_tokens[accumulated_sum + value] = SearchToken(token, accumulated_sum + value, i)\n",
    "\n",
    "        tokens = new_tokens\n",
    "\n",
    "    desired_sum = sum(values) // 2\n",
    "    best_token = None\n",
    "    best_diff = float('inf')\n",
    "    for accumulated_sum, token in tokens.items():\n",
    "        if best_diff > abs(accumulated_sum - desired_sum):\n",
    "            best_token = token\n",
    "            best_diff = abs(accumulated_sum - desired_sum)\n",
    "\n",
    "    return best_token.backtrace()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "993dca4d",
   "metadata": {},
   "outputs": [
    {
     "ename": "IndentationError",
     "evalue": "unexpected indent (<ipython-input-27-6dc34755ed3e>, line 2)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  File \u001b[1;32m\"<ipython-input-27-6dc34755ed3e>\"\u001b[1;36m, line \u001b[1;32m2\u001b[0m\n\u001b[1;33m    '''\u001b[0m\n\u001b[1;37m    ^\u001b[0m\n\u001b[1;31mIndentationError\u001b[0m\u001b[1;31m:\u001b[0m unexpected indent\n"
     ]
    }
   ],
   "source": [
    "def team_a(full_stuck = full_stuck, calc_teams_raiting = calc_teams_raiting, team_1 = team_1):\n",
    "    '''\n",
    "    На основе игроков участвующих сегодня в матче (датафрейм - full_stuck)\n",
    "    и рейтинга подсчитанного из calc_teams_raiting для 2-х команд\n",
    "    икроки раскидываются на два датафрейма team_a и team_b\n",
    "    '''   \n",
    "    calc_teams_raiting = calc_teams_raiting\n",
    "    full_stuck = full_stuck\n",
    "    team_1 = team_1\n",
    "    \n",
    "    t1, t2 = calc_teams_raiting()\n",
    "    pleyer_counter = full_stuck.name.tolist()\n",
    "    \n",
    "    for i in range(len(pleyer_counter)):\n",
    "        \n",
    "        if full_stuck.at[i,'rating'] in t1:\n",
    "            team_1 = team_1.append(full_stuck.loc[full_stuck['name'] == full_stuck.at[i,'name']], ignore_index=True)\n",
    "            \n",
    "            num = full_stuck.at[i,'rating']\n",
    "            t1.remove(num)\n",
    "            \n",
    "        if sum(t1) == team_1['rating'].sum():\n",
    "            break\n",
    "            \n",
    "    if sum(t1) == team_1['rating'].sum():\n",
    "        return team_1\n",
    "    else:\n",
    "        print('Ошибка набора в команду 1')\n",
    "# работает"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "456bdab5",
   "metadata": {},
   "outputs": [],
   "source": [
    "team_a()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2d76cb45",
   "metadata": {},
   "outputs": [],
   "source": [
    "def team_b(full_stuck = full_stuck, calc_teams_raiting = calc_teams_raiting, team_2 = team_2):\n",
    "    '''\n",
    "    На основе игроков участвующих сегодня в матче (датафрейм - full_stuck)\n",
    "    и рейтинга подсчитанного из calc_teams_raiting для 2-х команд\n",
    "    икроки раскидываются на два датафрейма team_a и team_b\n",
    "    Проходит по списку full_stuck с обратной стороны - (len(pleyer_counter) - 1, -1, -1)\n",
    "    '''   \n",
    "    calc_teams_raiting = calc_teams_raiting\n",
    "    t1, t2 = calc_teams_raiting()\n",
    "    full_stuck = full_stuck\n",
    "    team_2 = team_2\n",
    "    pleyer_counter = full_stuck.name.tolist()\n",
    "    for i in range(len(pleyer_counter) - 1, -1, -1):\n",
    "        if full_stuck.at[i,'rating'] in t2:\n",
    "            team_2 = team_2.append(full_stuck.loc[full_stuck['name'] == full_stuck.at[i,'name']], ignore_index=True)\n",
    "        if sum(t2) == team_2['rating'].sum():\n",
    "            break\n",
    "    if sum(t2) == team_2['rating'].sum():\n",
    "        return team_2\n",
    "    else:\n",
    "        print('Ошибка набора в команду 2')\n",
    "# работает"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c62b8ddb",
   "metadata": {},
   "outputs": [],
   "source": [
    "team_b()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "0848d3e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "def elo_raiting(team_a = team_a, team_b = team_b, winner = None, df = df):\n",
    "    \"\"\"\n",
    "    Вычисляется ожидаемое количество очков\n",
    "    если на вход параметра winner приходит 0 - ничья\n",
    "    если приходит 1 - Победила команда А\n",
    "    если приходит 2 - Победила команда B\n",
    "    \"\"\"\n",
    "\n",
    "    team_a = team_a\n",
    "    team_b = team_b\n",
    "    winner = winner\n",
    "    df = df\n",
    "    \n",
    "    K = 50\n",
    "    Ea = 1 / (1 + 10 ** ((team_b['rating'].sum() - team_a['rating'].sum()) / 2000))\n",
    "    \n",
    "\n",
    "    if winner == 1:\n",
    "        score1 = 1.0 \n",
    "        score2 = 0.0\n",
    "        print('Победила команда А')\n",
    "    elif winner == 2:\n",
    "        score1 = 0.0\n",
    "        score2 = 1.0        \n",
    "        print('Победила команда Б')\n",
    "    elif winner == 0:\n",
    "        score1 = 1 -Ea\n",
    "        score2 = Ea \n",
    "        print('Получается ничья')\n",
    "    else:\n",
    "        print('Итог матча не ясен')\n",
    "        \n",
    "    \n",
    "    Ra = team_a['rating'].sum() + K * (score1 - Ea)\n",
    "    Rb = team_b['rating'].sum() + K * (score2 - Ea)\n",
    "    \n",
    "    team_a_mmr = round(Ra - team_a['rating'].sum())\n",
    "    team_b_mmr = round(Rb - team_b['rating'].sum())\n",
    "    \n",
    "    \n",
    "    names_pool = df.name.tolist()\n",
    "    names_a = team_a.name.tolist()\n",
    "    names_b = team_b.name.tolist()\n",
    "    \n",
    "    for i in range(len(names_pool)):\n",
    "        # для команды А\n",
    "        if df.at[i,'name'] in names_a  and  winner == 1: # выигрыш данной команды\n",
    "            df.at[i, \"rating\"] += team_a_mmr\n",
    "            df.at[i, \"games\"] += 1\n",
    "            df.at[i, \"wins\"] += 1\n",
    "            df.at[i, \"winrate\"] = df.at[i, \"wins\"] / df.at[i, \"games\"] * 100\n",
    "        elif df.at[i,'name'] in names_a  and  winner == 2: # проигрыш данной команды \n",
    "            df.at[i, \"rating\"] += team_a_mmr\n",
    "            df.at[i, \"games\"] += 1\n",
    "            df.at[i, \"defeats\"] += 1\n",
    "        elif df.at[i,'name'] in names_a  and  winner == 0: # Ничья\n",
    "            df.at[i, \"rating\"] += team_a_mmr\n",
    "            df.at[i, \"games\"] += 1\n",
    "            df.at[i, \"draws\"] += 1     \n",
    "        # для команды В\n",
    "        if df.at[i,'name'] in names_b and  winner == 2: # выигрыш данной команды\n",
    "            df.at[i, \"rating\"] += team_b_mmr\n",
    "            df.at[i, \"games\"] += 1\n",
    "            df.at[i, \"wins\"] += 1\n",
    "            df.at[i, \"winrate\"] = df.at[i, \"wins\"] / df.at[i, \"games\"] * 100\n",
    "        elif df.at[i,'name'] in names_b  and  winner == 1: # проигрыш данной команды \n",
    "            df.at[i, \"rating\"] += team_b_mmr\n",
    "            df.at[i, \"games\"] += 1\n",
    "            df.at[i, \"defeats\"] += 1\n",
    "        elif df.at[i,'name'] in names_b  and  winner == 0: # Ничья\n",
    "            df.at[i, \"rating\"] += team_b_mmr\n",
    "            df.at[i, \"games\"] += 1\n",
    "            df.at[i, \"draws\"] += 1 \n",
    "            \n",
    "    print('Шанс на победу команды Б =', Ea)        \n",
    "    print('Команда 1 получает =',team_a_mmr, 'очков')\n",
    "    print('Команда 2 получает =',team_b_mmr, 'очков')\n",
    "    \n",
    "    return df\n",
    "            \n",
    "                \n",
    "\n",
    "# работает"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "f78eff91",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Победила команда А\n",
      "Шанс на победу команды Б = 0.5287505638922686\n",
      "Команда 1 получает = 24 очков\n",
      "Команда 2 получает = -26 очков\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>rating</th>\n",
       "      <th>games</th>\n",
       "      <th>wins</th>\n",
       "      <th>defeats</th>\n",
       "      <th>draws</th>\n",
       "      <th>winrate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Николай</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Миша</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Кэп</td>\n",
       "      <td>2549.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Ваня</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Макс</td>\n",
       "      <td>2449.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Андрей</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Кирпич</td>\n",
       "      <td>2549.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Даня</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Валера</td>\n",
       "      <td>2549.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Толя</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Кирилл (Родионов)</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Вася</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Роман</td>\n",
       "      <td>2474.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Саша</td>\n",
       "      <td>2474.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Костя</td>\n",
       "      <td>2474.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Стас</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Кирилл (высокий с Ваниной работы)</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Влад</td>\n",
       "      <td>2524.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                 name  rating  games  wins  defeats  draws  \\\n",
       "0                             Николай  2500.0    0.0   0.0      0.0    0.0   \n",
       "1                                Миша  2500.0    0.0   0.0      0.0    0.0   \n",
       "2                                 Кэп  2549.0    2.0   2.0      0.0    0.0   \n",
       "3                                Ваня  2475.0    1.0   0.0      1.0    0.0   \n",
       "4                                Макс  2449.0    2.0   0.0      2.0    0.0   \n",
       "5                              Андрей  2475.0    1.0   0.0      1.0    0.0   \n",
       "6                              Кирпич  2549.0    2.0   2.0      0.0    0.0   \n",
       "7                                Даня  2500.0    0.0   0.0      0.0    0.0   \n",
       "8                              Валера  2549.0    2.0   2.0      0.0    0.0   \n",
       "9                                Толя  2525.0    1.0   1.0      0.0    0.0   \n",
       "10                  Кирилл (Родионов)  2525.0    1.0   1.0      0.0    0.0   \n",
       "11                               Вася  2475.0    1.0   0.0      1.0    0.0   \n",
       "12                              Роман  2474.0    1.0   0.0      1.0    0.0   \n",
       "13                               Саша  2474.0    1.0   0.0      1.0    0.0   \n",
       "14                              Костя  2474.0    1.0   0.0      1.0    0.0   \n",
       "15                               Стас  2500.0    0.0   0.0      0.0    0.0   \n",
       "16  Кирилл (высокий с Ваниной работы)  2475.0    1.0   0.0      1.0    0.0   \n",
       "17                               Влад  2524.0    1.0   1.0      0.0    0.0   \n",
       "\n",
       "    winrate  \n",
       "0       0.0  \n",
       "1       0.0  \n",
       "2     100.0  \n",
       "3       0.0  \n",
       "4       0.0  \n",
       "5       0.0  \n",
       "6     100.0  \n",
       "7       0.0  \n",
       "8     100.0  \n",
       "9     100.0  \n",
       "10    100.0  \n",
       "11      0.0  \n",
       "12      0.0  \n",
       "13      0.0  \n",
       "14      0.0  \n",
       "15      0.0  \n",
       "16      0.0  \n",
       "17    100.0  "
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "elo_raiting(winner=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fecba901",
   "metadata": {},
   "outputs": [],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "06c2259e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>name</th>\n",
       "      <th>rating</th>\n",
       "      <th>games</th>\n",
       "      <th>wins</th>\n",
       "      <th>defeats</th>\n",
       "      <th>draws</th>\n",
       "      <th>winrate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Кэп</td>\n",
       "      <td>2549.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Кирпич</td>\n",
       "      <td>2549.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Валера</td>\n",
       "      <td>2549.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Толя</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Кирилл (Родионов)</td>\n",
       "      <td>2525.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Влад</td>\n",
       "      <td>2524.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Ваня</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Андрей</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Вася</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Кирилл (высокий с Ваниной работы)</td>\n",
       "      <td>2475.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Роман</td>\n",
       "      <td>2474.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Саша</td>\n",
       "      <td>2474.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Костя</td>\n",
       "      <td>2474.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Макс</td>\n",
       "      <td>2449.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                 name  rating  games  wins  defeats  draws  \\\n",
       "2                                 Кэп  2549.0    2.0   2.0      0.0    0.0   \n",
       "6                              Кирпич  2549.0    2.0   2.0      0.0    0.0   \n",
       "8                              Валера  2549.0    2.0   2.0      0.0    0.0   \n",
       "9                                Толя  2525.0    1.0   1.0      0.0    0.0   \n",
       "10                  Кирилл (Родионов)  2525.0    1.0   1.0      0.0    0.0   \n",
       "17                               Влад  2524.0    1.0   1.0      0.0    0.0   \n",
       "3                                Ваня  2475.0    1.0   0.0      1.0    0.0   \n",
       "5                              Андрей  2475.0    1.0   0.0      1.0    0.0   \n",
       "11                               Вася  2475.0    1.0   0.0      1.0    0.0   \n",
       "16  Кирилл (высокий с Ваниной работы)  2475.0    1.0   0.0      1.0    0.0   \n",
       "12                              Роман  2474.0    1.0   0.0      1.0    0.0   \n",
       "13                               Саша  2474.0    1.0   0.0      1.0    0.0   \n",
       "14                              Костя  2474.0    1.0   0.0      1.0    0.0   \n",
       "4                                Макс  2449.0    2.0   0.0      2.0    0.0   \n",
       "\n",
       "    winrate  \n",
       "2     100.0  \n",
       "6     100.0  \n",
       "8     100.0  \n",
       "9     100.0  \n",
       "10    100.0  \n",
       "17    100.0  \n",
       "3       0.0  \n",
       "5       0.0  \n",
       "11      0.0  \n",
       "16      0.0  \n",
       "12      0.0  \n",
       "13      0.0  \n",
       "14      0.0  \n",
       "4       0.0  "
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "srt = df.loc[df['games'] != 0].head(18)\n",
    "srt.sort_values(['rating'], ascending=[False])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "8e42e629",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Сохранение завершено\n"
     ]
    }
   ],
   "source": [
    "save_df()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ea647707",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
